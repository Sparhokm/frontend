<!DOCTYPE html>
<html lang="ru">
<head>
	@@include('scaff/layout__meta-tags.html')
	@@include('scaff/layout__css-list.html')


	<title>Классика на все времена</title>


	<!-- здесь подключай свои стили -->
	<!-- НАПРИМЕР: <link rel="stylesheet" href="css/catalog.min.css"> -->
</head>
<body>
	<div class="page">
		<header class="page__header">
			@@include('scaff/layout__header.html')
		</header>


		<main class="page__content">

			<div class="section">
				<div class="promo-page">

					<!-- баннер -->
					<div class="promo-page__banner">
						<div class="section__inner">

							<!-- таймер -->
							<div class="promo-page__banner-timer">
								<div class="promo-page__banner-timer-title">
									До розыгрыша <br>призов осталось:
								</div>

							</div>

							<!-- счетчик -->
							<div class="countdown" data-finish="2018/03/15 00:00:00">
								<div class="block-time days">
									<div class="figure days days-1">
										<span class="top"></span>
										<span class="top-back">
											<span></span>
										</span>
										<span class="bottom"></span>
										<span class="bottom-back">
											<span></span>
										</span>
									</div>

									<div class="figure days days-2">
										<span class="top"></span>
										<span class="top-back">
											<span></span>
										</span>
										<span class="bottom"></span>
										<span class="bottom-back">
											<span></span>
										</span>
									</div>
									<span class="count-title">Дней</span>
								</div>

								<div class="block-time hours">
									<div class="figure hours hours-1">
										<span class="top"></span>
										<span class="top-back">
											<span></span>
										</span>
										<span class="bottom"></span>
										<span class="bottom-back">
											<span></span>
										</span>
									</div>

									<div class="figure hours hours-2">
										<span class="top"></span>
										<span class="top-back">
											<span></span>
										</span>
										<span class="bottom"></span>
										<span class="bottom-back">
											<span></span>
										</span>
									</div>
									<span class="count-title">Часов</span>
								</div>

								<div class="block-time min">
									<div class="figure min min-1">
										<span class="top"></span>
										<span class="top-back">
											<span></span>
										</span>
										<span class="bottom"></span>
										<span class="bottom-back">
											<span></span>
										</span>
									</div>

									<div class="figure min min-2">
										<span class="top"></span>
										<span class="top-back">
											<span></span>
										</span>
										<span class="bottom"></span>
										<span class="bottom-back">
											<span></span>
										</span>
									</div>
									<span class="count-title">Минут</span>
								</div>

								<div class="block-time sec">
									<div class="figure sec sec-1">
										<span class="top"></span>
										<span class="top-back">
											<span></span>
										</span>
										<span class="bottom"></span>
										<span class="bottom-back">
											<span></span>
										</span>
									</div>

									<div class="figure sec sec-2">
										<span class="top"></span>
										<span class="top-back">
											<span></span>
										</span>
										<span class="bottom"></span>
										<span class="bottom-back">
											<span></span>
										</span>
									</div>
									<span class="count-title">Секунд</span>
								</div>
							</div>

							<!-- видео -->
							<div class="promo-page__banner-video">
								<table>
									<tr>
										<td class="top-left"></td>
										<td class="top-center"></td>
										<td class="top-right"></td>
									</tr>
									<tr>
										<td class="left-center"></td>
										<td class="center-content">
											<div class="videoWrapper">
												<iframe width="100%" src="https://www.youtube.com/embed/IdSWNCx19TY" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
											</div>
										</td>
										<td class="right-center"></td>
									</tr>
									<tr>
										<td class="bottom-left"></td>
										<td class="bottom-center"></td>
										<td class="bottom-right"></td>
									</tr>
								</table>
							</div>

						</div>
					</div>

					<div class="promo-page__inform">
						<div class="section__inner">
							<div class="promo-page__inform-main">
								<img src="../images/promo-page/icon/priz.png" alt="priz">
								<div class="promo-page__inform-main__title">
									Главные призы
								</div>
							</div>
							<div class="promo-page__inform-other">
								<img src="../images/promo-page/icon/samolet.png" alt="samolet">
								<div class="promo-page__inform-other__text">
									<span>1 место</span>
									Поездка на три дня<br> в Париж на двоих.
								</div>
							</div>
							<div class="promo-page__inform-other">
								<img src="../images/promo-page/icon/sertificat.png" alt="sertificat">
								<div class="promo-page__inform-other__text">
									<span>2 место</span>
									Сертификат<br> на 25 000 рублей.
								</div>
							</div>
							<div class="promo-page__inform-other">
								<img src="../images/promo-page/icon/sertificat.png" alt="sertificat">
								<div class="promo-page__inform-other__text">
									<span>3 место</span>
									Сертификат<br> на 15 000 рублей.
								</div>
							</div>
						</div>
					</div>

					<div class="promo-page__registration">
						<div class="section__inner">

							<div class="promo-page__registration-image">
								<img src="../images/promo-page/banner1.jpg" alt="">
							</div>

							<form action="" class="promo-page__registration-form">
								<div class="promo-page__registration-form__title">
									Регистрация участников
								</div>
								<div class="form__field numbers">
									<label class="form__field-label">Введите номер чека</label>
									<input type="text" class="form__field-input" name="ticket" placeholder="000.0000.000000.0000">
									<div class="form__field-tip">
										<span>?</span>
										<div>
											<img src="../images/promo-page/ticket.jpg" alt="">
										</div>
									</div>
								</div>

								<div class="form__field list">
									<label class="form__field-label">Магазин, где был получен подарок и чек</label>
									<select class="form__field-input" name="storeid">
										<option value="0" selected disabled>Выберите из списка</option>
										<option value="1">Магазин раз</option>
										<option value="2">Магазин два</option>
										<option value="3">Магазин три</option>
									</select>
								</div>

								<button class="form__field-btn">Учавствовать в розыгрыше</button>
							</form>

							<div class="promo-page__registration-success">Регистрация успешно <br>завершена!</div>

						</div>
					</div>

					<footer class="promo-page__footer">
						<div class="section__inner">
							<h2 class="promo-page__footer-title">Мечтаешь о Париже?</h2>

							<ol class="promo-page__footer-imgnumlist">
								<li>
									<div>СДЕЛАЙ конкурсное ФОТО</div>
									в специальной рамке в любом магазине 585 GOLD
								</li>
								<li>
									<div>ПОЛУЧИ ПОДАРОК</div>
									Стильное украшение<br>
									и чек для розыгрыша
								</li>
								<li>
									<div>Выложи фото</div>
									В Facebook, Instagramm<br>
									или Vkontakte
								</li>
								<li>
									<div>УЧАСТВУЙ В РОЗЫГРЫШЕ</div>
									<a href="#">Регистируйся сейчас</a>
								</li>
							</ol>

							<div class="promo-page__footer-cols">
								<div>
									<h3 class="promo-page__footer-subtitle">Условия участия:</h3>

									<ol class="promo-page__footer-numlist">
										<li>Сфотографируйтесь в&nbsp;магазине на&nbsp;фоне специальной промо-рамки с&nbsp;Джокондой.</li>
										<li>Предъявите бонусную карту или зарегистрируйте новую, если у&nbsp;вас её&nbsp;ещё нет.*</li>
										<li>Получите гарантированный подарок и&nbsp;чек с&nbsp;уникальным промо-кодом**. </li>
										<li>Выложите фотографию в&nbsp;социальной сети (ВКонтакте/Facebook/Instagram)*** с&nbsp;конкурсным текстом и&nbsp;хештегом #НайдиДжоконду. Отметьте в&nbsp;публикации двух друзей.</li>
										<li>Зарегистрируйтесь.****	</li>
									</ol>
								</div>

								<div>
									<h3 class="promo-page__footer-subtitle">Конкурсный текст:</h3>

									<ul class="promo-page__footer-list">
										<li data-ico="instagram">«Я хочу выиграть поездку в Париж и участвую в конкурсе от @zoloto585.ru #НайдиДжоконду. @user_name, @user_name – встретимся в Париже?» </li>
										<li data-ico="vk">«Я хочу выиграть поездку в Париж и участвую в конкурсе от @zoloto585gold #НайдиДжоконду. @user_name, @user_name – встретимся в Париже?» </li>
										<li data-ico="fb">«Я хочу выиграть поездку в Париж и участвую в конкурсе от @585 GOLD #НайдиДжоконду. @user_name, @user_name – встретимся в Париже?»</li>
									</ul>
								</div>
							</div>

							<div class="promo-page__footer-note">
								*Если у Вас еще нет карты, ее можно получить в магазине или зарегистрировать онлайн. <br>
								** чек имеет уникальный номер, который будет участвовать в розыгрыше.<br>
								***с 10 февраля по 16 марта у участников конкурса должен быть открыт профиль в Instagram, пост в его страницы на Facebook должен быть доступен для всех (регулируется в настройках приватности публикации).  Формат аккаунта: https://www.facebook.com/id, https://vk.com/id, https://www.instagram.com/id. <br>
								****Введите номер чека и выберите магазин, где был получен подарок и чек<br>
							</div>
						</div>
					</footer>

					<div class="promo-page__luckytext">
						<div class="section__inner">
							Испытайте удачу, приняв участие в конкурсе «Найди Джоконду»! Быть может, именно вы станете тем счастливчиком, который вскоре увидит оригинал знаменитой Джоконды в Лувре…
						</div>
					</div>

				</div>
			</div>

		</main>


		<footer class="page__footer">
			@@include('scaff/layout__footer.html')
		</footer>
	</div>

	@@include('scaff/layout__js-list.html')

	<script>

		;(function () {
			'use strict';

			$(document).ready(function () {
				var dt = new Date();

				var Countdown = {
				
					// Backbone-like structure
					$el: $('.countdown'),
					
					// Params
					countdown_interval: null,
					total_seconds     : 0,
					
					// Initialize the countdown  
					init: function() {
						// Date finish
						var finishDt = new Date(this.$el.data('finish'));
						var deltaDt = Math.abs(finishDt.getTime() - dt.getTime()) / 1000;

						this.values = {};
						this.values.days = Math.floor(deltaDt / 86400);
					
						deltaDt -= this.values.days * 86400;

						this.values.hours = Math.floor(deltaDt / 3600) % 24;

						deltaDt -= this.values.hours * 3600;

						this.values.minutes = Math.floor(deltaDt / 60) % 60;

						deltaDt -= this.values.minutes * 60;

						this.values.seconds = Math.floor(deltaDt % 60);

						this.total_seconds = finishDt.getTime() - dt.getTime();

						// DOM
						this.$ = {
							days   : this.$el.find('.block-time.days .figure'),
							hours  : this.$el.find('.block-time.hours .figure'),
							minutes: this.$el.find('.block-time.min .figure'),
							seconds: this.$el.find('.block-time.sec .figure')
						};

						// Animate countdown to the end 
						this.count();
					},
					
					count: function() {
						
						var that    = this,
							$days_1 = this.$.days.eq(0),
							$days_2 = this.$.days.eq(1),
							$hour_1 = this.$.hours.eq(0),
							$hour_2 = this.$.hours.eq(1),
							$min_1  = this.$.minutes.eq(0),
							$min_2  = this.$.minutes.eq(1),
							$sec_1  = this.$.seconds.eq(0),
							$sec_2  = this.$.seconds.eq(1);
						
							this.countdown_interval = setInterval(function() {

								if(that.total_seconds > 0) {

									--that.values.seconds;              

									if(that.values.minutes >= 0 && that.values.seconds < 0) {

										that.values.seconds = 59;
										--that.values.minutes;
									}

									if(that.values.hours >= 0 && that.values.minutes < 0) {

										that.values.minutes = 59;
										--that.values.hours;
									}

									if(that.values.days >= 0 && that.values.hours < 0) {

										that.values.hours = 23;
										--that.values.days; 
									}

									// Update DOM values

									// Days
									that.checkHour(that.values.days, $days_1, $days_2);

									// Hours
									that.checkHour(that.values.hours, $hour_1, $hour_2);

									// Minutes
									that.checkHour(that.values.minutes, $min_1, $min_2);

									// Seconds
									that.checkHour(that.values.seconds, $sec_1, $sec_2);

									--that.total_seconds;
								}
								else {
									clearInterval(that.countdown_interval);
								}
							}, 1000);    
					},
					
					animateFigure: function($el, value) {
						
						var that         = this,
							$top         = $el.find('.top'),
							$bottom      = $el.find('.bottom'),
							$back_top    = $el.find('.top-back'),
							$back_bottom = $el.find('.bottom-back');

						// Before we begin, change the back value
						$back_top.find('span').html(value);

						// Also change the back bottom value
						$back_bottom.find('span').html(value);

						// Then animate
						TweenMax.to($top, .85, {
							rotationX           : '-180deg',
							transformPerspective: 300,
							ease                : Quart.easeOut,
							onComplete          : function() {

								$top.html(value);

								$bottom.html(value);

								TweenMax.set($top, { rotationX: 0 });
							}
						});

						TweenMax.to($back_top, .85, { 
							rotationX           : 0,
							transformPerspective: 300,
							ease                : Quart.easeOut, 
							clearProps          : 'all' 
						});    
					},
					
					checkHour: function(value, $el_1, $el_2) {
						
						var val_1       = value.toString().charAt(0),
							val_2       = value.toString().charAt(1),
							fig_1_value = $el_1.find('.top').html(),
							fig_2_value = $el_2.find('.top').html();

						if(value >= 10) {

							// Animate only if the figure has changed
							if(fig_1_value !== val_1) this.animateFigure($el_1, val_1);
							if(fig_2_value !== val_2) this.animateFigure($el_2, val_2);
						}
						else {

							// If we are under 10, replace first figure with 0
							if(fig_1_value !== '0') this.animateFigure($el_1, 0);
							if(fig_2_value !== val_1) this.animateFigure($el_2, val_1);
						}    
					}
				};

				// Let's go !
				Countdown.init();

				// Inputs & Selector
				$('.promo-page__registration')
					.find('[name=ticket]').mask('999.9999.999999.9999').end()
					.find('[name=storeid]')
						.fancySelect().on('change.fs', function() {
							$(this).trigger('change.$');
						});

				// Send
				$('.promo-page__registration [data-btn=send]').on('click', function (e) {
					var $wrap = $(this).closest('[data-wrap]');
					var send = true;
					var data = {
						ticket: 0,
						storeid: 0,
					};

					e.preventDefault();

					$wrap.find('[data-invalid]').removeAttr('data-invalid');
					
					$.each(data, function(key, val) {
						var $el = $wrap.find('[name="'+ key +'"]');
						var $elWrap = $el.closest('[data-wrap]');
						var val = 0;

						if ($el.length) {
							val = $el.val();
						}

						if (val == 0) {
							$elWrap.find('label').attr('data-invalid', 1);
							send = false;
						}

						data[key] = val;
					});

					if (send) {
						$.get('/action/klassika_na_vse_vremena/ajax/addTicket.php', data);

						$wrap
							.find('form').hide().end()
							.find('[data-status]').show();
					}
				});

				// Scroll to form
				$('.promo-page [data-btn=goToForm]').on('click', function (e) {
					e.preventDefault();

					$('html, body').animate({ 
						scrollTop: $('.promo-page__registration').offset().top - 50 
					}, 200);
				});
			});
		} ());

	</script>
</body>
</html>
